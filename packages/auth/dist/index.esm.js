import{jsx as e,Fragment as t,jsxs as r}from"react/jsx-runtime";import{createContext as a,useState as i,useMemo as n,useCallback as o,useEffect as l,useContext as s,useRef as d}from"react";import c from"axios";import{Navigate as u}from"react-router-dom";function h(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(e,a[i])&&(r[a[i]]=e[a[i]])}return r}function m(e,t,r,a){return new(r||(r=Promise))((function(i,n){function o(e){try{s(a.next(e))}catch(e){n(e)}}function l(e){try{s(a.throw(e))}catch(e){n(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,l)}s((a=a.apply(e,t||[])).next())}))}"function"==typeof SuppressedError&&SuppressedError;const g="https://api.altan.ai/tables";const p=e=>{if(!e)return!1;try{const t=(e=>{const t=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),r=decodeURIComponent(window.atob(t).split("").map((e=>`%${`00${e.charCodeAt(0).toString(16)}`.slice(-2)}`)).join(""));return JSON.parse(r)})(e),r=Date.now();return 1e3*t.exp>r+1}catch(e){return!1}},v=(e,t)=>{t?e.defaults.headers.common.Authorization=`Bearer ${t}`:(delete e.defaults.headers.common.Authorization,y("logged out"))},f=c.create({baseURL:g,withCredentials:!0});let b=null;const x=new class{constructor(){this.controllers=new Map}hashString(e){let t=5381;for(let r=0;r<e.length;r++)t=33*t^e.charCodeAt(r);return(t>>>0).toString(36)}getRequestKey(e){const{method:t,url:r,params:a,data:i}=e,n=JSON.stringify({method:t,url:r,params:a,data:i});return this.hashString(n)}add(e){var t;const r=this.getRequestKey(e);this.controllers.has(r)&&(null===(t=this.controllers.get(r))||void 0===t||t.abort("Canceled duplicate request"),this.controllers.delete(r));const a=new AbortController;e.signal=a.signal,this.controllers.set(r,a)}remove(e){let t;t=e.headers&&e.headers["x-request-key"]?e.headers["x-request-key"]:this.getRequestKey(e),this.controllers.delete(t)}cancel(e,t="Operation canceled"){var r;this.controllers.has(e)&&(null===(r=this.controllers.get(e))||void 0===r||r.abort(t),this.controllers.delete(e))}cancelAll(e="Operation canceled"){this.controllers.forEach((t=>{t.abort(e)})),this.controllers.clear()}},y=e=>{x.cancelAll(e)},w=a(null);function N({children:t,tableId:r,storageKey:a="",onAuthStateChange:s,authenticationOptions:d={persistSession:!0,redirectUrl:"/login"}}){const[u,y]=i(null),[N,k]=i(null),[$,C]=i(!0),A=n((()=>(e=>{const t=c.create({baseURL:g});return t.interceptors.request.use((r=>m(void 0,void 0,void 0,(function*(){x.add(r),r.signal||"undefined"==typeof AbortController||(b=new AbortController,r.signal=b.signal);const a=t.defaults.headers.common.Authorization;if(a&&"string"==typeof a&&a.startsWith("Bearer ")){let i=a.substring(7);if(!p(i)){const{data:r}=yield f.post(`/auth/refresh?table_id=${e}`);i=r.access_token,v(t,i)}r.headers.Authorization=`Bearer ${i}`}return r}))),(e=>Promise.reject(e))),t.interceptors.response.use((e=>(x.remove(e.config),e)),(e=>m(void 0,void 0,void 0,(function*(){var r,a;const i=e.config;if(!i)return Promise.reject(e);if(x.remove(i),i._retryCount=i._retryCount||0,401===(null===(r=e.response)||void 0===r?void 0:r.status)&&i._retryCount<1){i._retryCount++;const{data:e}=yield f.post("/auth/refresh"),r=e.access_token;return v(t,r),i.headers.Authorization=`Bearer ${r}`,t(i)}return(null===(a=e.response)||void 0===a?void 0:a.status)>=500?Promise.reject(new Error("A server error occurred. Please try again later.")):Promise.reject(e)})))),t})(r)),[r]),P=e=>Object.assign({id:Number(e.id||0),email:e.email||"",name:e.name,surname:e.surname,avatar:Array.isArray(e.avatar)?e.avatar:[],verified:Boolean(e.verified)},Object.fromEntries(Object.entries(e).filter((([e])=>!["id","email","name","surname","avatar","verified"].includes(e))))),j=o((()=>m(this,void 0,void 0,(function*(){try{yield f.post("/auth/logout")}finally{v(A,null),y(null)}}))),[A,d.persistSession,r]);l((()=>{null==s||s(u)}),[u,s]);const L=o((e=>m(this,[e],void 0,(function*({email:e,password:t}){var a,i;try{C(!0),k(null);const a=new URLSearchParams;a.append("username",e),a.append("password",t);const{data:{access_token:i}}=yield A.post(`/auth/login?table_id=${r}`,a,{headers:{"Content-Type":"application/x-www-form-urlencoded"}});v(A,i);const{data:n}=yield A.get("/auth/me"),o=P(n);y(o)}catch(e){const t=(null===(i=null===(a=e.response)||void 0===a?void 0:a.data)||void 0===i?void 0:i.detail)||"Invalid email or password";throw k(new Error(t)),e}finally{C(!1)}}))),[A,d.persistSession,r]),S=o((e=>m(this,void 0,void 0,(function*(){var t,a,{email:i,password:n,name:o,surname:l}=e,s=h(e,["email","password","name","surname"]);try{C(!0),k(null);200===(yield f.post(`/auth/register?table_id=${r}`,Object.assign({email:i,password:n,name:o,surname:l},s))).status&&(yield L({email:i,password:n}))}catch(e){const r=(null===(a=null===(t=e.response)||void 0===t?void 0:t.data)||void 0===a?void 0:a.detail)||"Registration failed";throw k(new Error(r)),e}finally{C(!1)}}))),[A,L,r]);l((()=>{(()=>{m(this,void 0,void 0,(function*(){try{const{data:e}=yield A.get("/auth/me"),t=P(e);y(t)}catch(e){y(null)}finally{C(!1)}}))})()}),[A,r]);const M=o((e=>m(this,void 0,void 0,(function*(){throw new Error("Not implemented")}))),[]),_=o((e=>m(this,void 0,void 0,(function*(){if(!u)throw new Error("No user logged in");try{C(!0),k(null);const t=Object.assign({},e);"avatar"in e&&(null===e.avatar?t.avatar=[]:"string"==typeof e.avatar?t.avatar=[{file_name:"avatar.jpg",mime_type:"image/jpeg",file_content:e.avatar}]:t.avatar=e.avatar);const r=yield A.patch("/auth/update",t),a=P(r.data.user);y(a)}catch(e){throw k(e instanceof Error?e:new Error("Profile update failed")),e}finally{C(!1)}}))),[u,A,d.persistSession,r]),B=o((()=>m(this,void 0,void 0,(function*(){try{C(!0),k(null);window.open(`https://api.altan.ai/tables/auth/google/authorize?table_id=${r}&redirect_url=${encodeURIComponent(window.location.origin)}`,"Auth","width=600,height=600,scrollbars=yes");const e=yield new Promise(((e,t)=>{let r;function a(i){if("https://api.altan.ai"!==i.origin)return;r&&clearTimeout(r),window.removeEventListener("message",a);const n=i.data;n.error?t(new Error(n.error)):n.success?e(n):t(new Error("Invalid response format"))}window.addEventListener("message",a),r=setTimeout((()=>{window.removeEventListener("message",a),t(new Error("Authentication timed out"))}),12e4)})),{access_token:t,user:a}=e;d.persistSession&&t&&v(A,t);const{data:i}=yield A.get("/auth/me"),n=P(i);return y(n),n}catch(e){const t=e instanceof Error?e.message:"Authentication failed";throw k(new Error(t)),e}finally{C(!1)}}))),[A,r,d.persistSession]),E=n((()=>({user:u,isLoading:$,error:N,isAuthenticated:!!u,login:L,logout:j,register:S,resetPassword:M,updateProfile:_,continueWithGoogle:()=>m(this,void 0,void 0,(function*(){yield B()})),api:A})),[u,$,N,L,j,S,M,_,B,A]);return e(w.Provider,{value:E,children:t})}function k(){const e=s(w);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e}function $(){const{user:e,isAuthenticated:t}=k();return{user:e,isAuthenticated:t}}function C(){const{isLoading:e}=k();return e}function A(){const{error:e}=k();return e}function P(){const{login:e,logout:t,register:r,resetPassword:a,updateProfile:i,continueWithGoogle:n}=k();return{login:e,logout:t,register:r,resetPassword:a,updateProfile:i,continueWithGoogle:n}}function j(e=!0){const t=s(w);if(!t){if(e)throw new Error("useAuth must be used within an AuthProvider");return null}return t.api}function L({children:r,redirectTo:a="/login"}){const{isAuthenticated:i,isLoading:n}=k();return n?e("div",{children:"Loading..."}):i?e(t,{children:r}):e(u,{to:a,replace:!0})}function S(){return r("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",viewBox:"0 0 32 32",width:"20",height:"20",children:[e("defs",{children:e("path",{id:"A",d:"M44.5 20H24v8.5h11.8C34.7 33.9 30.1 37 24 37c-7.2 0-13-5.8-13-13s5.8-13 13-13c3.1 0 5.9 1.1 8.1 2.9l6.4-6.4C34.6 4.1 29.6 2 24 2 11.8 2 2 11.8 2 24s9.8 22 22 22c11 0 21-8 21-22 0-1.3-.2-2.7-.5-4z"})}),e("clipPath",{id:"B",children:e("use",{xlinkHref:"#A"})}),r("g",{transform:"matrix(.727273 0 0 .727273 -.954545 -1.45455)",children:[e("path",{d:"M0 37V11l17 13z",clipPath:"url(#B)",fill:"#fbbc05"}),e("path",{d:"M0 11l17 13 7-6.1L48 14V0H0z",clipPath:"url(#B)",fill:"#ea4335"}),e("path",{d:"M0 37l30-23 7.9 1L48 0v48H0z",clipPath:"url(#B)",fill:"#34a853"}),e("path",{d:"M48 48L17 24l-4-3 35-10z",clipPath:"url(#B)",fill:"#4285f4"})]})]})}function M(t){var a,n,{appearance:o={theme:"light"},companyName:l,signUpUrl:s="/sign-up",routing:d="path",withSignUp:c=!0}=t,u=h(t,["appearance","companyName","signUpUrl","routing","withSignUp"]);const{continueWithGoogle:g,login:p,isLoading:v,isAuthenticated:f,error:b}=k(),[x,y]=i((null===(a=u.initialValues)||void 0===a?void 0:a.emailAddress)||""),[w,N]=i((null===(n=u.initialValues)||void 0===n?void 0:n.password)||""),$={light:{background:"bg-white",card:"bg-white",text:"text-gray-900",textMuted:"text-gray-600",input:"bg-white text-gray-900 border-gray-300",button:"bg-black hover:bg-gray-900 text-white",googleButton:"bg-white hover:bg-gray-50 text-gray-700 border-gray-300",error:{background:"bg-red-50",text:"text-red-800",icon:"text-red-400"}},dark:{background:"bg-gray-900",card:"bg-gray-800",text:"text-white",textMuted:"text-gray-300",input:"bg-gray-800 text-white border-gray-600",button:"bg-white hover:bg-gray-100 text-black",googleButton:"bg-gray-800 hover:bg-gray-700 text-white border-gray-600",error:{background:"bg-red-900/20",text:"text-red-200",icon:"text-red-400"}}}[o.theme||"light"];if(f)return null;return r("div",{className:"max-w-md w-full mx-auto space-y-8",children:[r("div",{children:[e("h2",{className:`text-center text-3xl font-bold ${$.text}`,children:l?`Sign in to ${l}`:"Sign in"}),e("p",{className:`mt-2 text-center text-sm ${$.textMuted}`,children:"Welcome back! Please sign in to continue"})]}),e("button",{onClick:()=>g(),className:`w-full flex justify-center py-2 px-4 border rounded-md shadow-sm text-sm font-medium ${$.googleButton}`,children:r("span",{className:"flex items-center",children:[e(S,{}),e("span",{className:"ml-2",children:"Continue with Google"})]})}),r("div",{className:"relative",children:[e("div",{className:"absolute inset-0 flex items-center",children:e("div",{className:"w-full border-t "+("dark"===o.theme?"border-gray-700":"border-gray-300")})}),e("div",{className:"relative flex justify-center text-sm",children:e("span",{className:`px-2 ${$.card} ${$.textMuted}`,children:"or"})})]}),r("form",{className:"mt-8 space-y-6",onSubmit:e=>m(this,void 0,void 0,(function*(){e.preventDefault(),yield p({email:x,password:w})})),children:[r("div",{children:[e("label",{htmlFor:"email",className:`block text-sm font-medium ${$.text}`,children:"Email address"}),e("input",{id:"email",type:"email",required:!0,className:`mt-1 block w-full border rounded-md shadow-sm py-2 px-3 ${$.input}`,value:x,onChange:e=>y(e.target.value)})]}),r("div",{children:[e("label",{htmlFor:"password",className:`block text-sm font-medium ${$.text}`,children:"Password"}),e("input",{id:"password",type:"password",required:!0,className:`mt-1 block w-full border rounded-md shadow-sm py-2 px-3 ${$.input}`,value:w,onChange:e=>N(e.target.value)})]}),b&&e("div",{className:`rounded-md ${$.error.background} p-4`,children:r("div",{className:"flex",children:[e("div",{className:"flex-shrink-0",children:e("svg",{className:`h-5 w-5 ${$.error.icon}`,viewBox:"0 0 20 20",fill:"currentColor",children:e("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),e("div",{className:"ml-3",children:e("p",{className:`text-sm font-medium ${$.error.text}`,children:b.message})})]})}),e("button",{type:"submit",className:`w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium ${$.button}`,disabled:v,children:v?"Signing in...":"Continue"})]}),r("div",{className:`mt-8 border-t ${"dark"===o.theme?"border-gray-700":"border-gray-200"} pt-6`,children:[c&&r("div",{className:"text-center mb-4",children:[e("span",{className:$.textMuted,children:"Don't have an account? "}),e("a",{href:s,onClick:e=>{e.preventDefault(),"hash"===d?window.location.hash=s:window.location.href=s},className:"text-blue-600 hover:text-blue-400",children:"Sign up"})]}),r("div",{className:`flex items-center justify-center space-x-2 text-xs ${$.textMuted}`,children:[e("span",{children:"Secured by"}),e("img",{src:"dark"===o.theme?"https://altan.ai/logos/horizontalWhite.png":"https://altan.ai/logos/horizontalBlack.png",alt:"Altan",className:"h-3"})]})]})]})}function _(t){var a,n,{appearance:o={theme:"light"},companyName:l,signInUrl:s="/sign-in",routing:d="path",withSignIn:c=!0}=t,u=h(t,["appearance","companyName","signInUrl","routing","withSignIn"]);const{continueWithGoogle:g,register:p,isLoading:v,isAuthenticated:f,error:b}=k(),[x,y]=i((null===(a=u.initialValues)||void 0===a?void 0:a.emailAddress)||""),[w,N]=i((null===(n=u.initialValues)||void 0===n?void 0:n.password)||""),[$,C]=i(""),[A,P]=i(null),j={light:{background:"bg-white",card:"bg-white",text:"text-gray-900",textMuted:"text-gray-600",input:"bg-white text-gray-900 border-gray-300",button:"bg-black hover:bg-gray-900 text-white",googleButton:"bg-white hover:bg-gray-50 text-gray-700 border-gray-300",error:{background:"bg-red-50",text:"text-red-800",icon:"text-red-400"}},dark:{background:"bg-gray-900",card:"bg-gray-800",text:"text-white",textMuted:"text-gray-300",input:"bg-gray-800 text-white border-gray-600",button:"bg-white hover:bg-gray-100 text-black",googleButton:"bg-gray-800 hover:bg-gray-700 text-white border-gray-600",error:{background:"bg-red-900/20",text:"text-red-200",icon:"text-red-400"}}}[o.theme||"light"];if(f)return null;return r("div",{className:"max-w-md w-full mx-auto space-y-8",children:[r("div",{children:[e("h2",{className:`text-center text-3xl font-bold ${j.text}`,children:l?`Create your ${l} account`:"Create account"}),e("p",{className:`mt-2 text-center text-sm ${j.textMuted}`,children:"Get started by creating your account"})]}),e("button",{onClick:()=>g(),className:`w-full flex justify-center py-2 px-4 border rounded-md shadow-sm text-sm font-medium ${j.googleButton}`,children:r("span",{className:"flex items-center",children:[e(S,{}),e("span",{className:"ml-2",children:"Continue with Google"})]})}),r("div",{className:"relative",children:[e("div",{className:"absolute inset-0 flex items-center",children:e("div",{className:"w-full border-t "+("dark"===o.theme?"border-gray-700":"border-gray-300")})}),e("div",{className:"relative flex justify-center text-sm",children:e("span",{className:`px-2 ${j.card} ${j.textMuted}`,children:"or"})})]}),r("form",{className:"mt-8 space-y-6",onSubmit:e=>m(this,void 0,void 0,(function*(){if(e.preventDefault(),P(null),w===$)try{yield p({email:x,password:w,displayName:""})}catch(e){}else P("Passwords don't match")})),children:[r("div",{children:[e("label",{htmlFor:"email",className:`block text-sm font-medium ${j.text}`,children:"Email address"}),e("input",{id:"email",type:"email",required:!0,className:`mt-1 block w-full border rounded-md shadow-sm py-2 px-3 ${j.input}`,value:x,onChange:e=>y(e.target.value)})]}),r("div",{children:[e("label",{htmlFor:"password",className:`block text-sm font-medium ${j.text}`,children:"Password"}),e("input",{id:"password",type:"password",required:!0,className:`mt-1 block w-full border rounded-md shadow-sm py-2 px-3 ${j.input}`,value:w,onChange:e=>N(e.target.value)})]}),r("div",{children:[e("label",{htmlFor:"confirmPassword",className:`block text-sm font-medium ${j.text}`,children:"Confirm Password"}),e("input",{id:"confirmPassword",type:"password",required:!0,className:`mt-1 block w-full border rounded-md shadow-sm py-2 px-3 ${j.input}`,value:$,onChange:e=>C(e.target.value)})]}),(b||A)&&e("div",{className:`rounded-md ${j.error.background} p-4`,children:r("div",{className:"flex",children:[e("div",{className:"flex-shrink-0",children:e("svg",{className:`h-5 w-5 ${j.error.icon}`,viewBox:"0 0 20 20",fill:"currentColor",children:e("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),e("div",{className:"ml-3",children:e("p",{className:`text-sm font-medium ${j.error.text}`,children:A||(null==b?void 0:b.message)})})]})}),e("button",{type:"submit",className:`w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium ${j.button}`,disabled:v,children:v?"Creating account...":"Create account"})]}),r("div",{className:`mt-8 border-t ${"dark"===o.theme?"border-gray-700":"border-gray-200"} pt-6`,children:[c&&r("div",{className:"text-center mb-4",children:[e("span",{className:j.textMuted,children:"Already have an account? "}),e("a",{href:s,onClick:e=>{e.preventDefault(),"hash"===d?window.location.hash=s:window.location.href=s},className:"text-blue-600 hover:text-blue-400",children:"Sign in"})]}),r("div",{className:`flex items-center justify-center space-x-2 text-xs ${j.textMuted}`,children:[e("span",{children:"Secured by"}),e("img",{src:"dark"===o.theme?"https://altan.ai/logos/horizontalWhite.png":"https://altan.ai/logos/horizontalBlack.png",alt:"Altan",className:"h-3"})]})]})]})}function B({appearance:t={theme:"light"},onLogout:a,className:i=""}){const{logout:n}=P(),o={light:{button:"text-red-600 hover:text-red-800"},dark:{button:"text-red-400 hover:text-red-200"}}[t.theme||"light"];return r("button",{onClick:()=>m(this,void 0,void 0,(function*(){try{yield n(),null==a||a()}catch(e){console.error("Logout failed:",e)}})),className:`flex items-center space-x-2 px-4 py-2 rounded-md hover:bg-red-50 dark:hover:bg-red-900/20 ${o.button} ${i}`,children:[e("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),e("span",{children:"Logout"})]})}const E=["id","verified","created_time","last_modified_time","last_modified_by","password","avatar"],z=["name","surname"];function O({appearance:t={theme:"light"},routing:a="path",path:n="/user-profile",showCustomFields:o=!0,editableFields:l=z,hiddenFields:s=[],customPages:c=[],fallback:u}){var h;const{user:g,updateProfile:p,isLoading:v,error:f}=k(),[b,x]=i(!1),[y,w]=i({}),N=d(null);if(!g)return u||null;const $={light:{background:"bg-gray-50",card:"bg-white",text:"text-gray-900",textSecondary:"text-gray-700",textMuted:"text-gray-500",border:"border-gray-300",primary:"bg-primary-600 hover:bg-primary-700",buttonText:"text-white"},dark:{background:"bg-gray-900",card:"bg-gray-800",text:"text-white",textSecondary:"text-gray-300",textMuted:"text-gray-400",border:"border-gray-700",primary:"bg-primary-500 hover:bg-primary-600",buttonText:"text-white"}}[t.theme||"light"],C=[...E,...s];return e("div",{className:`max-w-4xl mx-auto py-10 px-4 sm:px-6 lg:px-8 ${$.background}`,children:r("div",{className:"space-y-8",children:[r("div",{className:`${$.card} shadow rounded-lg p-6`,children:[r("div",{className:"flex justify-between items-start mb-6",children:[e("h1",{className:`text-2xl font-bold ${$.text}`,children:"Profile Settings"}),e(B,{appearance:t})]}),r("div",{className:"flex items-center space-x-6",children:[r("div",{className:"relative",children:[e("div",{className:"w-24 h-24 rounded-full overflow-hidden bg-gray-200",children:Array.isArray(g.avatar)&&(null===(h=g.avatar[0])||void 0===h?void 0:h.url)?e("img",{src:g.avatar[0].url,alt:"Profile",className:"w-full h-full object-cover"}):e("div",{className:`w-full h-full flex items-center justify-center ${$.textMuted}`,children:e("svg",{className:"w-12 h-12",fill:"currentColor",viewBox:"0 0 24 24",children:e("path",{d:"M24 20.993V24H0v-2.996A14.977 14.977 0 0112.004 15c4.904 0 9.26 2.354 11.996 5.993zM16.002 8c0 2.208-1.79 4-3.998 4-2.208 0-3.998-1.792-3.998-4s1.79-4 3.998-4c2.208 0 3.998 1.792 3.998 4z"})})})}),e("input",{type:"file",ref:N,onChange:e=>m(this,void 0,void 0,(function*(){var t;const r=null===(t=e.target.files)||void 0===t?void 0:t[0];if(r)try{const e=new FileReader;e.onloadend=()=>m(this,void 0,void 0,(function*(){const t=e.result;yield p({avatar:[{file_name:"avatar.jpg",mime_type:r.type||"image/jpeg",file_content:t.split(",")[1]}]})})),e.readAsDataURL(r)}catch(e){console.error("Failed to update avatar:",e)}})),accept:"image/*",className:"hidden"}),e("button",{onClick:()=>{var e;return null===(e=N.current)||void 0===e?void 0:e.click()},className:`absolute bottom-0 right-0 p-1.5 rounded-full ${$.primary} ${$.buttonText}`,children:e("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})})]}),r("div",{children:[e("h2",{className:`text-2xl font-bold ${$.text}`,children:g.name||g.email}),Array.isArray(g.avatar)&&g.avatar.length>0&&e("button",{onClick:()=>p({avatar:[]}),className:`text-sm ${$.textMuted} hover:${$.text}`,children:"Remove avatar"})]})]})]}),e("div",{className:`${$.card} shadow rounded-lg`,children:r("div",{className:"px-4 py-5 sm:p-6",children:[r("div",{className:"flex justify-between items-center mb-6",children:[e("h3",{className:`text-lg font-medium ${$.text}`,children:"Profile Information"}),e("button",{onClick:b?()=>m(this,void 0,void 0,(function*(){try{yield p(y),x(!1)}catch(e){}})):()=>{w(g),x(!0)},disabled:b&&v,className:`px-4 py-2 rounded-md ${$.primary} ${$.buttonText} disabled:opacity-50`,children:b?v?"Saving...":"Save Changes":"Edit Profile"})]}),e("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:Object.entries(g).filter((([e])=>!(C.includes(e)||"avatar"===e||!o&&!z.includes(e)))).map((([e,t])=>{let r=t;return Array.isArray(t)?r=t.join(", "):null==t?r="":"object"==typeof t&&(r=JSON.stringify(t)),[e,r]})).map((([t,a])=>r("div",{className:"space-y-1",children:[e("label",{className:`block text-sm font-medium ${$.textMuted}`,children:t.replace(/_/g," ").replace(/\b\w/g,(e=>e.toUpperCase()))}),b&&l.includes(t)?e("input",{type:"text",value:y[t]||"",onChange:e=>w((r=>Object.assign(Object.assign({},r),{[t]:e.target.value}))),className:`block w-full rounded-md ${$.border} shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm ${$.card} ${$.text} p-2`}):e("div",{className:`text-sm ${$.text} p-2 rounded-md ${"bg-white"===$.card?"bg-gray-50":"bg-gray-700"}`,children:a||"Not set"})]},t)))})]})}),f&&e("div",{className:"rounded-md bg-red-50 dark:bg-red-900 p-4",children:r("div",{className:"flex",children:[e("div",{className:"flex-shrink-0",children:e("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:e("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),e("div",{className:"ml-3",children:e("p",{className:"text-sm font-medium text-red-800 dark:text-red-200",children:f.message})})]})})]})})}export{N as AuthProvider,B as Logout,L as ProtectedRoute,M as SignIn,_ as SignUp,O as UserProfile,k as useAuth,j as useAuthAPI,P as useAuthActions,A as useAuthError,C as useAuthLoading,$ as useAuthUser};
//# sourceMappingURL=index.esm.js.map
